<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Serie A - Dati Stagioni</title>
    <link rel="stylesheet" href="https://maxcdn.bootstrapcdn.com/bootstrap/4.5.2/css/bootstrap.min.css">
    <link rel="stylesheet" href="{{ url_for('static', filename='styles.css') }}">
    <link rel="stylesheet" href="https://cdn.datatables.net/1.10.21/css/jquery.dataTables.min.css">
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/toastr.js/latest/toastr.min.css">
</head>
<body>
    <div class="container mt-5">
        <h1 class="text-center mb-4">Dati delle Stagioni di Serie A</h1>
        <div class="form-group">
            <label for="season-select">Seleziona la stagione:</label>
            <select id="season-select" class="form-control">
                <option value="1929_1930">1929-1930</option>
                <option value="1930_1931">1930-1931</option>
                <option value="1931_1932">1931-1932</option>
                <option value="1932_1933">1932-1933</option>
                <option value="1933_1934">1933-1934</option>
                <option value="1934_1935">1934-1935</option>
                <option value="1935_1936">1935-1936</option>
                <option value="1936_1937">1936-1937</option>
                <option value="1937_1938">1937-1938</option>
                <option value="1938_1939">1938-1939</option>
                <option value="1939_1940">1939-1940</option>
                <option value="1940_1941">1940-1941</option>
                <option value="1941_1942">1941-1942</option>
                <option value="1942_1943">1942-1943</option>
                <option value="1946_1947">1946-1947</option>
                <option value="1947_1948">1947-1948</option>
                <option value="1948_1949">1948-1949</option>
                <option value="1949_1950">1949-1950</option>
                <option value="1950_1951">1950-1951</option>
                <option value="1951_1952">1951-1952</option>
                <option value="1952_1953">1952-1953</option>
                <option value="1953_1954">1953-1954</option>
                <option value="1954_1955">1954-1955</option>
                <option value="1955_1956">1955-1956</option>
                <option value="1956_1957">1956-1957</option>
                <option value="1957_1958">1957-1958</option>
                <option value="1958_1959">1958-1959</option>
                <option value="1959_1960">1959-1960</option>
                <option value="1960_1961">1960-1961</option>
                <option value="1961_1962">1961-1962</option>
                <option value="1962_1963">1962-1963</option>
                <option value="1963_1964">1963-1964</option>
                <option value="1964_1965">1964-1965</option>
                <option value="1965_1966">1965-1966</option>
                <option value="1966_1967">1966-1967</option>
                <option value="1967_1968">1967-1968</option>
                <option value="1968_1969">1968-1969</option>
                <option value="1969_1970">1969-1970</option>
                <option value="1970_1971">1970-1971</option>
                <option value="1971_1972">1971-1972</option>
                <option value="1972_1973">1972-1973</option>
                <option value="1973_1974">1973-1974</option>
                <option value="1974_1975">1974-1975</option>
                <option value="1975_1976">1975-1976</option>
                <option value="1976_1977">1976-1977</option>
                <option value="1977_1978">1977-1978</option>
                <option value="1978_1979">1978-1979</option>
                <option value="1979_1980">1979-1980</option>
                <option value="1980_1981">1980-1981</option>
                <option value="1981_1982">1981-1982</option>
                <option value="1982_1983">1982-1983</option>
                <option value="1983_1984">1983-1984</option>
                <option value="1984_1985">1984-1985</option>
                <option value="1985_1986">1985-1986</option>
                <option value="1986_1987">1986-1987</option>
                <option value="1987_1988">1987-1988</option>
                <option value="1988_1989">1988-1989</option>
                <option value="1989_1990">1989-1990</option>
                <option value="1990_1991">1990-1991</option>
                <option value="1991_1992">1991-1992</option>
                <option value="1992_1993">1992-1993</option>
                <option value="1993_1994">1993-1994</option>
                <option value="1994_1995">1994-1995</option>
                <option value="1995_1996">1995-1996</option>
                <option value="1996_1997">1996-1997</option>
                <option value="1997_1998">1997-1998</option>
                <option value="1998_1999">1998-1999</option>
                <option value="1999_2000">1999-2000</option>
                <option value="2000_2001">2000-2001</option>
                <option value="2001_2002">2001-2002</option>
                <option value="2002_2003">2002-2003</option>
                <option value="2003_2004">2003-2004</option>
                <option value="2004_2005">2004-2005</option>
                <option value="2005_2006">2005-2006</option>
                <option value="2006_2007">2006-2007</option>
                <option value="2007_2008">2007-2008</option>
                <option value="2008_2009">2008-2009</option>
                <option value="2009_2010">2009-2010</option>
                <option value="2010_2011">2010-2011</option>
                <option value="2011_2012">2011-2012</option>
                <option value="2012_2013">2012-2013</option>
                <option value="2013_2014">2013-2014</option>
                <option value="2014_2015">2014-2015</option>
                <option value="2015_2016">2015-2016</option>
                <option value="2016_2017">2016-2017</option>
                <option value="2017_2018">2017-2018</option>
                <option value="2018_2019">2018-2019</option>
                <option value="2019_2020">2019-2020</option>
                <option value="2020_2021">2020-2021</option>
                <option value="2021_2022">2021-2022</option>
                <option value="2022_2023">2022-2023</option>
                <option value="2023_2024">2023-2024</option>
            </select>
        </div>
        <button class="btn btn-primary" onclick="getSeasonData()">Visualizza Dati</button>
        <div id="loading" style="display: none;" class="text-center mt-3">
            <img src="https://i.gifer.com/ZZ5H.gif" alt="Caricamento...">
        </div>
        <div id="data-container" class="mt-4"></div>
    </div>

    <script src="https://code.jquery.com/jquery-3.5.1.min.js"></script>
    <script src="https://cdn.datatables.net/1.10.21/js/jquery.dataTables.min.js"></script>
    <script src="https://cdn.jsdelivr.net/npm/chart.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/toastr.js/latest/toastr.min.js"></script>
    <script>
        function getSeasonData() {
            const season = document.getElementById('season-select').value;
            document.getElementById('loading').style.display = 'block';
            fetch(`/get_season_data?season=${season}`)
                .then(response => response.json())
                .then(data => {
                    document.getElementById('loading').style.display = 'none';
                    const container = document.getElementById('data-container');
                    container.innerHTML = ''; // Pulisci i dati precedenti

                    if (data.error) {
                        toastr.error(data.error);
                    } else {
                        let table = `
                            <table id="data-table" class="table table-striped table-bordered mt-4">
                                <thead class="thead-dark">
                                    <tr>
                                        <th>ID</th>
                                        <th>Data</th>
                                        <th>Squadra Casa</th>
                                        <th>Squadra Ospite</th>
                                        <th>Risultato</th>
                                    </tr>
                                </thead>
                                <tbody>
                        `;
                        data.forEach(row => {
                            table += `
                                <tr>
                                    <td>${row.id}</td>
                                    <td>${row.date}</td>
                                    <td>${row.home_team}</td>
                                    <td>${row.away_team}</td>
                                    <td>${row.score}</td>
                                </tr>
                            `;
                        });
                        table += '</tbody></table>';
                        container.innerHTML = table;
                        $('#data-table').DataTable();
                        toastr.success('Dati caricati con successo!');
                    }
                })
                .catch(error => {
                    document.getElementById('loading').style.display = 'none';
                    toastr.error('Errore durante il caricamento dei dati.');
                    console.error('Errore:', error);
                });
        }
    </script>
</body>
</html>
